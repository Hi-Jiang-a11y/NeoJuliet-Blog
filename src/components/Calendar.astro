---
import "../styles/Calendar.css";
---

<div class="calendar-container">
    <h1 class="calendar-title">Calendar</h1>

    <!-- 这里由客户端 JS 动态渲染 -->
    <div id="calendar-root"></div>

</div>

<!-- 客户端 JS：确保在浏览器执行，而不是构建时执行 -->
<script>
    const now = new Date();

    const year = now.getFullYear();
    const month = now.getMonth();
    const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    const daysOfWeek = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];

    // 当前月份天数与本月第一天是星期几
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    const firstDay = new Date(year, month, 1).getDay();

    function isToday(date) {
        return (
            date.getFullYear() === now.getFullYear() &&
            date.getMonth() === now.getMonth() &&
            date.getDate() === now.getDate()
        );
    }

    const calendarRoot = document.getElementById("calendar-root");

    // 标题
    const header = `
        <div class="calendar-header">
            <h3>${monthNames[month]} ${year}</h3>
        </div>
    `;

    // 网格
    let grid = `<div class="calendar-grid">`;

    // 星期栏
    for (const d of daysOfWeek) {
        grid += `<div class="calendar-day-week">${d}</div>`;
    }

    // 前置空白格
    for (let i = 0; i < firstDay; i++) {
        grid += `<div class="calendar-day empty"></div>`;
    }

    // 日期格
    for (let day = 1; day <= daysInMonth; day++) {
        const dateObj = new Date(year, month, day);
        const cls = isToday(dateObj) ? "today" : "";
        grid += `<div class="calendar-day ${cls}">${day}</div>`;
    }

    grid += `</div>`;

    // 渲染到页面
    calendarRoot.innerHTML = header + grid;
</script>

