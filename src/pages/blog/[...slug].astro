---
import Layout from '../../layouts/Layout.astro';
import BaseHead from '../../components/BaseHead.astro';
import { type CollectionEntry, getCollection, render } from 'astro:content';
import FormattedDate from '../../components/FormattedDate.astro';
import '../../styles/blog-content.css';
import '../../styles/RightbarContainers/blogcontentrightbarcontainer.css';
import Toc from '../../components/Toc.astro';
type Props = CollectionEntry<'blog'>;


export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map(post => ({
    params: { slug: post.id },
    props: post,
  }));
}

const post = Astro.props;
const { Content, headings } = await render(post);
const { title, description, pubDate, updatedDate, author } = post.data;
---
<Layout>
    <BaseHead slot="head" title={title} description={description} />

    <div class="blog-content">
        <!-- 文章内容 -->
        <article class="blog-post" style="flex:1;" id="article-content">
            <h1 class="title">{title}</h1>

            <div class="date">
                <FormattedDate date={pubDate} />
                {updatedDate && ( <div class="last-updated"> 
                    Last updated on <FormattedDate date={updatedDate} />
                </div>
                )}
            </div>
            <hr />

            <div class="prose">
                <Content />
            </div>
        </article>
    </div>
    <!--右边目录栏--!>
    <div slot="rightbar" class="blogcontentrightbarcontainer">
        <Toc headings={headings} />
    </div>
</Layout>
